<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:lang="http://www.springframework.org/schema/lang" xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-4.2.xsd
		http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-4.2.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd">
	
	<!-- EXAMPLE: Define a proxy configuration -->
	<bean id="proxy" class="com.fortify.util.rest.ProxyConfiguration">
		<property name="uri" value="http://proxy:port/"/>
		<property name="userName" value="proxy user (optional)"/>
		<property name="password" value="proxy password (optional)"/>
	</bean>
	
	<!-- ACTIVE: Define the FoD connection information like base URL, user
	     credentials, and optional proxy. For connecting to FoD using client
	     credentials, please see FoDConnectionFactoryClientCredentialsEmeaDemo
	     below.
	     
	     Tenant, username and password can be configured here. Each of these
	     can be overridden on the command line by setting the
	     -Dfod.tenant=..., -Dfod.username=... and/or -Dfod.password=...
	     system properties. If any of these values is not configured here,
	     and the corresponding system property is not set on the command line,
	     the user will be prompted to enter the tenant, username and/or password.
    -->
	<bean id="FoDConnectionFactoryUserCredentials" class="com.fortify.fod.connection.FoDConnectionFactoryUserCredentials">
		<property name="baseUrl" value="https://emea.hpfod.com/"/>
		<property name="tenant" value="emeademo"/>
		<!-- <property name="userName" value="username"/> -->
		<!-- <property name="password" value="password"/> -->
		<!-- <property name="proxy" ref="proxy"/> -->
	</bean>
	
	<!-- EXAMPLE: Define the FoD connection information like base URL, client
	     credentials, and optional proxy. -->
	<bean id="FoDConnectionFactoryClientCredentials" class="com.fortify.fod.connection.FoDConnectionFactoryClientCredentials">
		<property name="baseUrl" value="https://emea.hpfod.com/"/>
		<property name="clientId" value="API key"/>
		<property name="clientSecret" value="client secret"/>
		<!-- <property name="proxy" ref="proxy"/> -->
	</bean>
	
	<bean id="fodToFileProcessor" class="com.fortify.processrunner.fod.file.FoDProcessorSubmitVulnerabilitiesToFile">
		<property name="fod.connectionFactory" ref="FoDConnectionFactoryUserCredentials"/>
		
		<property name="fod.topLevelFieldSimpleFilters"><map>
			<!-- <entry key="severityString" value="Critical"/> -->
			<!-- <entry key="hasComments" value="true"/> -->
			<!-- <entry key="assignedUser" value="Taylor, Jon"/> -->
		</map></property>
		<property name="fod.topLevelFieldRegExFilters"><map>
			<entry key="vulnId" value="5.*"/>
		</map></property>
		<property name="fod.allFieldRegExFilters"><map>
			<!-- <entry key="summary.developerStatus" value="Open"/> -->
		</map></property>
		
		<property name="file.fieldHeaders" value="vulnId,category,primaryLocationFull"/>
		<property name="file.fieldExpressionTemplates" value="${vulnId},${category},${primaryLocationFull}"/>
		
	</bean>
	
	<!-- INVOKE: This processor runner will get the vulnerabilities for release ID as
	     specified by system property fod.releaseId, and process them as defined by 
	     abstractFoDEmeaDemoUserCredentialsProcessorRunner -->
	<bean id="defaultProcessorRunner" class="com.fortify.processrunner.ProcessRunner">
		<property name="processor" ref="fodToFileProcessor"/>
	</bean>
</beans>
